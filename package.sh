#!/bin/sh

if test z$1 = z; then
    echo "USAGE: package.sh <pkgdir>"
    echo "This should only be used by invoking \"make package\", and then"
    echo "only on Windows or other non-UNIX platforms."
fi

PKGDIR=$1

rm -rf $PKGDIR
mkdir -pm 0755 $PKGDIR
cp -rf mod/* $PKGDIR
cp wasp* $PKGDIR
cd $PKGDIR

cat >site/config.ms <<EOF
;;; Generated by package.sh
(set-site-config! 'stub-path ".")
(set-site-config! 'bin-path ".")
(set-site-config! 'mod-path '("."))
EOF

../waspc -exe waspc.exe   -stub waspvm.exe bin/waspc
../waspc -exe wasp.exe    -stub waspvm.exe bin/wasp
../waspc -exe waspdoc.exe -stub waspvm.exe bin/waspdoc

